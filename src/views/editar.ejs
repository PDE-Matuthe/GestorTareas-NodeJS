<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <%- include ('partials/head.ejs') %>
</head>

<body>
  <%- include ('partials/nav.ejs') %>
    <main>
      <div class="container">
        <h1 class="text-center my-4">Editar Tarea</h1>
        <form action="/editar/<%= tarea.id%>" method="POST" class="needs-validation" novalidate>
          <div class="mb-3">
            <label for="titulo" class="form-label">Título</label>
            <input type="text" id="titulo" name="titulo" class="form-control"
              placeholder="Escribe el título de la tarea" required value="<%= tarea.titulo %>">
            <div class="invalid-feedback">
              Por favor, ingresa un título.
            </div>
          </div>
          <div class="mb-3">
            <label for="categoria" class="form-label">Categoría</label>
            <select id="categoria" name="categoria" class="form-select" required>
              <option value="" disabled>Selecciona una categoría</option>
              <option value="Trabajo" <%=tarea.categoria==='Trabajo' ? 'selected' : '' %>>Trabajo</option>
              <option value="Personal" <%=tarea.categoria==='Personal' ? 'selected' : '' %>>Personal</option>
              <option value="Hogar" <%=tarea.categoria==='Hogar' ? 'selected' : '' %>>Hogar</option>
              <option value="Estudios" <%=tarea.categoria==='Estudios' ? 'selected' : '' %>>Estudios</option>
              <option value="Finanzas" <%=tarea.categoria==='Finanzas' ? 'selected' : '' %>>Finanzas</option>
              <option value="Salud" <%=tarea.categoria==='Salud' ? 'selected' : '' %>>Salud</option>
              <option value="Entretenimiento" <%=tarea.categoria==='Entretenimiento' ? 'selected' : '' %>
                >Entretenimiento</option>
              <option value="Otro" <%=tarea.categoria==='Otro' ? 'selected' : '' %>>Otro</option>
            </select>
            <div class="invalid-feedback">
              Por favor, selecciona una categoría.
            </div>
          </div>

          <div class="mb-3">
            <label for="descripcion" class="form-label">Descripción (Opcional)</label>
            <textarea id="descripcion" name="descripcion" class="form-control" rows="4"
              placeholder="Describe la tarea"><%= tarea.descripcion%></textarea>
          </div>

          <div class="form-check mb-3">
            <input type="checkbox" class="form-check-input" id="completada" name="completada" value="1"
              <%=tarea.completada===1 ? 'checked' : '' %>>
            <label for="completada" class="form-check-label">Marcar como completada</label>
          </div>
          <div class="text-center">
            <button type="submit" class="btn btn-warning">Editar Tarea</button>
            <a href="/" class="btn btn-secondary">Cancelar</a>
          </div>
        </form>
      </div>
    </main>
    <%- include ('partials/footer.ejs') %>
      <script>
        // Bootstrap validation
        (function () {
          'use strict'
          const forms = document.querySelectorAll('.needs-validation')
          Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
              if (!form.checkValidity()) {
                event.preventDefault()
                event.stopPropagation()
              }
              form.classList.add('was-validated')
            }, false)
          })
        })()
      </script>
</body>

</html>